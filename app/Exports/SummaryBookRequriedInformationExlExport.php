<?php
namespace App\Exports;
  
use App\Models\MasterQuerieExcel;
use Maatwebsite\Excel\Concerns\FromCollection;
use DB;
use Maatwebsite\Excel\Concerns\WithHeadings;
use App\Models\Student;
use Session;
use Config;

use App\Component\CustomComponent;
use App\Models\ExamcenterDetail;
use App\Models\Subject;
use App\Exports\CenterCountExlExport;
use Auth;
use App\Http\Controllers\Controller;
use App\Helper\CustomHelper;

use Maatwebsite\Excel\Concerns\WithEvents;
use Maatwebsite\Excel\Events\AfterSheet;

class SummaryBookRequriedInformationExlExport implements FromCollection,WithHeadings,WithEvents 
{
    /**
    * @return \Illuminate\Support\Collection
    */
	
	function __construct($request) {
		// $this->exam_year = CustomHelper::_get_selected_sessions();
		// $this->course = @$request->course;
		// $this->exam_month = @$request->exam_month;
		// $this->medium = @$request->medium;
		
		$this->exam_year = CustomHelper::_get_selected_sessions();
		if($this->exam_year == ""){
			$this->exam_year = 126;
		}
		$this->exam_month = 1; //1,2
		 
		
		if($request == 1){
			$this->course = 10;$this->medium = 'hindi'; 
		}else if($request == 2){
			$this->course = 10;$this->medium = 'english'; 
		}else if($request == 3){
			$this->course = 12;$this->medium = 'hindi'; 
		}else if($request == 4){
			$this->course = 12;$this->medium = 'english'; 
		}else{
			echo "Something is Wrong.";die;
		}
		
		//10,12 //'hindi','english'
	 }
	 
	public function collection(){
		ini_set('memory_limit', '3000M');
		ini_set('max_execution_time', '0');
		
		$finalResults = [];
		
		$exam_year = @$this->exam_year;
		$exam_month = @$this->exam_month;
		$medium = @$this->medium;
		$course = @$this->course;
		
		$limit = 30000; 
		
		$q1 = null;
		$summaryQ1 = null;
		$summaryQ3 = null;
		
		/* Old
		if($course == 12 && $medium == 'hindi'){
			$q1 = "SELECT '12' as course,'hindi' as medium,CONCAT( u.ai_code, '-', u.college_name ) AS college_name, u.temp_district_id, u.ai_code AS ai_code, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 18 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_301_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 18 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_301_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 19 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_302_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 19 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_302_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 20 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_306_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 20 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_306_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 21 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_309_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 21 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_309_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 22 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_311_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 22 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_311_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 23 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_312_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 23 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_312_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 23 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_312_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 24 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_313_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 24 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_313_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 24 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_313_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 25 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_314_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 25 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_314_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 25 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_314_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 26 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_315_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 28 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_316_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 28 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_316_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 27 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_317_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 27 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_317_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 27 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_317_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 29 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_318_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 29 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_318_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 31 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_319_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 31 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_319_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 32 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_320_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 32 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_320_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 32 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_320_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 33 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_321_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 33 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_321_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 33 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_321_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 34 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_328_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 34 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_328_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 35 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_330_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 36 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_331_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 37 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_332_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 37 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_332_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 37 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_332_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 38 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_333_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 38 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_333_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 38 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_333_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 39 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_336_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = $exam_month AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.exam_year = $exam_year AND pb.course = 12 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1  GROUP BY u.ai_code ORDER BY u.ai_code ASC limit $limit;";
			$summaryQ1 = "SELECT u.temp_district_id, SUM(CASE WHEN  pb.subject_id = 18 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_301_1, SUM(CASE WHEN  pb.subject_id = 18 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_301_2, SUM(CASE WHEN  pb.subject_id = 19 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_302_1, SUM(CASE WHEN  pb.subject_id = 19 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_302_2, SUM(CASE WHEN  pb.subject_id = 20 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_306_1, SUM(CASE WHEN  pb.subject_id = 20 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_306_2, SUM(CASE WHEN  pb.subject_id = 21 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_309_1, SUM(CASE WHEN  pb.subject_id = 21 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_309_2, SUM(CASE WHEN  pb.subject_id = 22 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_311_1, SUM(CASE WHEN  pb.subject_id = 22 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_311_2, SUM(CASE WHEN  pb.subject_id = 23 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_312_1, SUM(CASE WHEN  pb.subject_id = 23 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_312_2, SUM(CASE WHEN  pb.subject_id = 23 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_312_3, SUM(CASE WHEN  pb.subject_id = 24 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_313_1, SUM(CASE WHEN  pb.subject_id = 24 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_313_2, SUM(CASE WHEN  pb.subject_id = 24 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_313_3, SUM(CASE WHEN  pb.subject_id = 25 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_314_1, SUM(CASE WHEN  pb.subject_id = 25 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_314_2, SUM(CASE WHEN  pb.subject_id = 25 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_314_3, SUM(CASE WHEN  pb.subject_id = 26 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_315_1, SUM(CASE WHEN  pb.subject_id = 28 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_316_1, SUM(CASE WHEN  pb.subject_id = 28 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_316_2, SUM(CASE WHEN  pb.subject_id = 27 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_317_1, SUM(CASE WHEN  pb.subject_id = 27 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_317_2, SUM(CASE WHEN  pb.subject_id = 27 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_317_3, SUM(CASE WHEN  pb.subject_id = 29 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_318_1, SUM(CASE WHEN  pb.subject_id = 29 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_318_2, SUM(CASE WHEN  pb.subject_id = 31 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_319_1, SUM(CASE WHEN  pb.subject_id = 31 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_319_2, SUM(CASE WHEN  pb.subject_id = 32 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_320_1, SUM(CASE WHEN  pb.subject_id = 32 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_320_2, SUM(CASE WHEN  pb.subject_id = 32 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_320_3, SUM(CASE WHEN  pb.subject_id = 33 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_321_1, SUM(CASE WHEN  pb.subject_id = 33 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_321_2, SUM(CASE WHEN  pb.subject_id = 33 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_321_3, SUM(CASE WHEN  pb.subject_id = 34 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_328_1, SUM(CASE WHEN  pb.subject_id = 34 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_328_2, SUM(CASE WHEN  pb.subject_id = 35 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_330_1, SUM(CASE WHEN  pb.subject_id = 36 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_331_1, SUM(CASE WHEN  pb.subject_id = 37 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_332_1, SUM(CASE WHEN  pb.subject_id = 37 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_332_2, SUM(CASE WHEN  pb.subject_id = 37 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_332_3, SUM(CASE WHEN  pb.subject_id = 38 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_333_1, SUM(CASE WHEN  pb.subject_id = 38 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_333_2, SUM(CASE WHEN  pb.subject_id = 38 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_333_3, SUM(CASE WHEN  pb.subject_id = 39 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_336_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = 1 AND pb.exam_year = 126 AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.course = 12 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 GROUP BY u.temp_district_id ORDER BY u.ai_code ASC;";
			$summaryQ3 = "SELECT SUM(CASE WHEN  pb.subject_id = 18 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_301_1, SUM(CASE WHEN  pb.subject_id = 18 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_301_2, SUM(CASE WHEN  pb.subject_id = 19 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_302_1, SUM(CASE WHEN  pb.subject_id = 19 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_302_2, SUM(CASE WHEN  pb.subject_id = 20 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_306_1, SUM(CASE WHEN  pb.subject_id = 20 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_306_2, SUM(CASE WHEN  pb.subject_id = 21 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_309_1, SUM(CASE WHEN  pb.subject_id = 21 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_309_2, SUM(CASE WHEN  pb.subject_id = 22 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_311_1, SUM(CASE WHEN  pb.subject_id = 22 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_311_2, SUM(CASE WHEN  pb.subject_id = 23 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_312_1, SUM(CASE WHEN  pb.subject_id = 23 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_312_2, SUM(CASE WHEN  pb.subject_id = 23 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_312_3, SUM(CASE WHEN  pb.subject_id = 24 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_313_1, SUM(CASE WHEN  pb.subject_id = 24 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_313_2, SUM(CASE WHEN  pb.subject_id = 24 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_313_3, SUM(CASE WHEN  pb.subject_id = 25 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_314_1, SUM(CASE WHEN  pb.subject_id = 25 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_314_2, SUM(CASE WHEN  pb.subject_id = 25 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_314_3, SUM(CASE WHEN  pb.subject_id = 26 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_315_1, SUM(CASE WHEN  pb.subject_id = 28 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_316_1, SUM(CASE WHEN  pb.subject_id = 28 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_316_2, SUM(CASE WHEN  pb.subject_id = 27 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_317_1, SUM(CASE WHEN  pb.subject_id = 27 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_317_2, SUM(CASE WHEN  pb.subject_id = 27 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_317_3, SUM(CASE WHEN  pb.subject_id = 29 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_318_1, SUM(CASE WHEN  pb.subject_id = 29 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_318_2, SUM(CASE WHEN  pb.subject_id = 31 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_319_1, SUM(CASE WHEN  pb.subject_id = 31 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_319_2, SUM(CASE WHEN  pb.subject_id = 32 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_320_1, SUM(CASE WHEN  pb.subject_id = 32 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_320_2, SUM(CASE WHEN  pb.subject_id = 32 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_320_3, SUM(CASE WHEN  pb.subject_id = 33 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_321_1, SUM(CASE WHEN  pb.subject_id = 33 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_321_2, SUM(CASE WHEN  pb.subject_id = 33 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_321_3, SUM(CASE WHEN  pb.subject_id = 34 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_328_1, SUM(CASE WHEN  pb.subject_id = 34 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_328_2, SUM(CASE WHEN  pb.subject_id = 35 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_330_1, SUM(CASE WHEN  pb.subject_id = 36 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_331_1, SUM(CASE WHEN  pb.subject_id = 37 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_332_1, SUM(CASE WHEN  pb.subject_id = 37 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_332_2, SUM(CASE WHEN  pb.subject_id = 37 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_332_3, SUM(CASE WHEN  pb.subject_id = 38 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_333_1, SUM(CASE WHEN  pb.subject_id = 38 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_333_2, SUM(CASE WHEN  pb.subject_id = 38 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_333_3, SUM(CASE WHEN  pb.subject_id = 39 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_336_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = 1 AND pb.exam_year = 126 AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.course = 12 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 ORDER BY u.ai_code ASC;";
		}else if($course == 12 && $medium == 'english'){
			$q1 = "SELECT '12' as course,'english' as medium,CONCAT( u.ai_code, '-', u.college_name ) AS college_name, u.temp_district_id, u.ai_code AS ai_code, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 18 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_301_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 18 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_301_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 19 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_302_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 19 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_302_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 20 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_306_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 20 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_306_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 21 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_309_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 21 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_309_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 22 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_311_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 22 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_311_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 23 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_312_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 23 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_312_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 23 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_312_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 24 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_313_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 24 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_313_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 24 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_313_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 25 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_314_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 25 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_314_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 25 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_314_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 26 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_315_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 28 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_316_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 28 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_316_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 27 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_317_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 27 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_317_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 27 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_317_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 29 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_318_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 29 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_318_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 31 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_319_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 31 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_319_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 32 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_320_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 32 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_320_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 32 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_320_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 33 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_321_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 33 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_321_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 33 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_321_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 34 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_328_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 34 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_328_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 35 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_330_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 36 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_331_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 37 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_332_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 37 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_332_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 37 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_332_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 38 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_333_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 38 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_333_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 38 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_333_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 39 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_336_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = $exam_month AND pb.exam_year = $exam_year AND pb.course = 12 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 GROUP BY u.ai_code ORDER BY u.ai_code ASC limit $limit;";
			$summaryQ1 = "SELECT u.temp_district_id, SUM(CASE WHEN  pb.subject_id = 18 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_301_1, SUM(CASE WHEN  pb.subject_id = 18 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_301_2, SUM(CASE WHEN  pb.subject_id = 19 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_302_1, SUM(CASE WHEN  pb.subject_id = 19 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_302_2, SUM(CASE WHEN  pb.subject_id = 20 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_306_1, SUM(CASE WHEN  pb.subject_id = 20 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_306_2, SUM(CASE WHEN  pb.subject_id = 21 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_309_1, SUM(CASE WHEN  pb.subject_id = 21 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_309_2, SUM(CASE WHEN  pb.subject_id = 22 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_311_1, SUM(CASE WHEN  pb.subject_id = 22 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_311_2, SUM(CASE WHEN  pb.subject_id = 23 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_312_1, SUM(CASE WHEN  pb.subject_id = 23 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_312_2, SUM(CASE WHEN  pb.subject_id = 23 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_312_3, SUM(CASE WHEN  pb.subject_id = 24 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_313_1, SUM(CASE WHEN  pb.subject_id = 24 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_313_2, SUM(CASE WHEN  pb.subject_id = 24 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_313_3, SUM(CASE WHEN  pb.subject_id = 25 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_314_1, SUM(CASE WHEN  pb.subject_id = 25 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_314_2, SUM(CASE WHEN  pb.subject_id = 25 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_314_3, SUM(CASE WHEN  pb.subject_id = 26 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_315_1, SUM(CASE WHEN  pb.subject_id = 28 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_316_1, SUM(CASE WHEN  pb.subject_id = 28 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_316_2, SUM(CASE WHEN  pb.subject_id = 27 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_317_1, SUM(CASE WHEN  pb.subject_id = 27 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_317_2, SUM(CASE WHEN  pb.subject_id = 27 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_317_3, SUM(CASE WHEN  pb.subject_id = 29 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_318_1, SUM(CASE WHEN  pb.subject_id = 29 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_318_2, SUM(CASE WHEN  pb.subject_id = 31 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_319_1, SUM(CASE WHEN  pb.subject_id = 31 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_319_2, SUM(CASE WHEN  pb.subject_id = 32 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_320_1, SUM(CASE WHEN  pb.subject_id = 32 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_320_2, SUM(CASE WHEN  pb.subject_id = 32 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_320_3, SUM(CASE WHEN  pb.subject_id = 33 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_321_1, SUM(CASE WHEN  pb.subject_id = 33 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_321_2, SUM(CASE WHEN  pb.subject_id = 33 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_321_3, SUM(CASE WHEN  pb.subject_id = 34 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_328_1, SUM(CASE WHEN  pb.subject_id = 34 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_328_2, SUM(CASE WHEN  pb.subject_id = 35 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_330_1, SUM(CASE WHEN  pb.subject_id = 36 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_331_1, SUM(CASE WHEN  pb.subject_id = 37 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_332_1, SUM(CASE WHEN  pb.subject_id = 37 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_332_2, SUM(CASE WHEN  pb.subject_id = 37 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_332_3, SUM(CASE WHEN  pb.subject_id = 38 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_333_1, SUM(CASE WHEN  pb.subject_id = 38 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_333_2, SUM(CASE WHEN  pb.subject_id = 38 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_333_3, SUM(CASE WHEN  pb.subject_id = 39 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_336_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = 1 AND pb.exam_year = 126 AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.course = 12 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 GROUP BY u.temp_district_id ORDER BY u.ai_code ASC;";
			$summaryQ3 = "SELECT SUM(CASE WHEN  pb.subject_id = 18 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_301_1, SUM(CASE WHEN  pb.subject_id = 18 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_301_2, SUM(CASE WHEN  pb.subject_id = 19 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_302_1, SUM(CASE WHEN  pb.subject_id = 19 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_302_2, SUM(CASE WHEN  pb.subject_id = 20 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_306_1, SUM(CASE WHEN  pb.subject_id = 20 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_306_2, SUM(CASE WHEN  pb.subject_id = 21 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_309_1, SUM(CASE WHEN  pb.subject_id = 21 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_309_2, SUM(CASE WHEN  pb.subject_id = 22 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_311_1, SUM(CASE WHEN  pb.subject_id = 22 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_311_2, SUM(CASE WHEN  pb.subject_id = 23 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_312_1, SUM(CASE WHEN  pb.subject_id = 23 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_312_2, SUM(CASE WHEN  pb.subject_id = 23 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_312_3, SUM(CASE WHEN  pb.subject_id = 24 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_313_1, SUM(CASE WHEN  pb.subject_id = 24 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_313_2, SUM(CASE WHEN  pb.subject_id = 24 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_313_3, SUM(CASE WHEN  pb.subject_id = 25 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_314_1, SUM(CASE WHEN  pb.subject_id = 25 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_314_2, SUM(CASE WHEN  pb.subject_id = 25 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_314_3, SUM(CASE WHEN  pb.subject_id = 26 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_315_1, SUM(CASE WHEN  pb.subject_id = 28 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_316_1, SUM(CASE WHEN  pb.subject_id = 28 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_316_2, SUM(CASE WHEN  pb.subject_id = 27 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_317_1, SUM(CASE WHEN  pb.subject_id = 27 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_317_2, SUM(CASE WHEN  pb.subject_id = 27 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_317_3, SUM(CASE WHEN  pb.subject_id = 29 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_318_1, SUM(CASE WHEN  pb.subject_id = 29 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_318_2, SUM(CASE WHEN  pb.subject_id = 31 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_319_1, SUM(CASE WHEN  pb.subject_id = 31 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_319_2, SUM(CASE WHEN  pb.subject_id = 32 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_320_1, SUM(CASE WHEN  pb.subject_id = 32 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_320_2, SUM(CASE WHEN  pb.subject_id = 32 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_320_3, SUM(CASE WHEN  pb.subject_id = 33 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_321_1, SUM(CASE WHEN  pb.subject_id = 33 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_321_2, SUM(CASE WHEN  pb.subject_id = 33 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_321_3, SUM(CASE WHEN  pb.subject_id = 34 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_328_1, SUM(CASE WHEN  pb.subject_id = 34 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_328_2, SUM(CASE WHEN  pb.subject_id = 35 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_330_1, SUM(CASE WHEN  pb.subject_id = 36 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_331_1, SUM(CASE WHEN  pb.subject_id = 37 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_332_1, SUM(CASE WHEN  pb.subject_id = 37 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_332_2, SUM(CASE WHEN  pb.subject_id = 37 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_332_3, SUM(CASE WHEN  pb.subject_id = 38 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_333_1, SUM(CASE WHEN  pb.subject_id = 38 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_333_2, SUM(CASE WHEN  pb.subject_id = 38 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_333_3, SUM(CASE WHEN  pb.subject_id = 39 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_336_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = 1 AND pb.exam_year = 126 AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.course = 12 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 ORDER BY u.ai_code ASC;";
		}else if($course == 10 && $medium == 'hindi'){
			$q1 = " SELECT '10' as course,'hindi' as medium,CONCAT( u.ai_code, '-', u.college_name ) AS college_name, u.temp_district_id, u.ai_code AS ai_code, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 1 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_201_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 1 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_201_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 2 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_202_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 2 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_202_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 9 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_206_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 10 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_207_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 41 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_208_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 11 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_210_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 6 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_209_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 6 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_209_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 4 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_211_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 4 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_211_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 4 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_211_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 3 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_212_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 3 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_212_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 3 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_212_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 5 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_213_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 12 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_214_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 12 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_214_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 30 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_215_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 13 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_216_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 13 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_216_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 13 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_216_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 17 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_222_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 17 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_222_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 40 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_223_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 16 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_225_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 16 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_225_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 16 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_225_3 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = $exam_month AND pb.exam_year = $exam_year AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.course = 10 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1  GROUP BY u.ai_code ORDER BY u.ai_code ASC limit $limit;";
			$summaryQ1 = "SELECT u.temp_district_id, SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_201_1, SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_201_2, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_202_1, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_202_2, SUM(CASE WHEN  pb.subject_id = 9 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_206_1, SUM(CASE WHEN  pb.subject_id = 10 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_207_1, SUM(CASE WHEN  pb.subject_id = 41 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_208_1, SUM(CASE WHEN  pb.subject_id = 11 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_210_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_209_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_209_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_211_1, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_211_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_211_3, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_212_1, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_212_2, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_212_3, SUM(CASE WHEN  pb.subject_id = 5 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_213_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_214_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_214_2, SUM(CASE WHEN  pb.subject_id = 30 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_215_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_216_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_216_2, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_216_3, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_222_1, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_222_2, SUM(CASE WHEN  pb.subject_id = 40 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_223_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_225_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_225_2, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_225_3 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.exam_year = $exam_year AND pb.course = 10 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 GROUP BY u.temp_district_id ORDER BY u.ai_code ASC limit $limit;";
			$summaryQ3 = "SELECT SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_201_1, SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_201_2, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_202_1, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_202_2, SUM(CASE WHEN  pb.subject_id = 9 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_206_1, SUM(CASE WHEN  pb.subject_id = 10 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_207_1, SUM(CASE WHEN  pb.subject_id = 41 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_208_1, SUM(CASE WHEN  pb.subject_id = 11 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_210_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_209_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_209_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_211_1, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_211_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_211_3, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_212_1, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_212_2, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_212_3, SUM(CASE WHEN  pb.subject_id = 5 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_213_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_214_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_214_2, SUM(CASE WHEN  pb.subject_id = 30 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_215_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_216_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_216_2, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_216_3, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_222_1, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_222_2, SUM(CASE WHEN  pb.subject_id = 40 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_223_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_225_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_225_2, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_225_3 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.exam_year = $exam_year AND pb.course = 10 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 ORDER BY u.ai_code ASC limit $limit;";
		}else if($course == 10 && $medium == 'english'){
			$q1 = "SELECT '10' as course,'english' as medium,CONCAT( u.ai_code, '-', u.college_name ) AS college_name, u.temp_district_id, u.ai_code AS ai_code, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 1 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_201_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 1 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_201_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 2 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_202_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 2 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_202_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 9 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_206_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 10 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_207_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 41 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_208_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 11 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_210_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 6 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_209_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 6 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_209_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 4 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_211_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 4 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_211_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 4 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_211_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 3 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_212_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 3 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_212_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 3 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_212_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 5 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_213_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 12 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_214_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 12 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_214_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 30 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_215_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 13 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_216_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 13 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_216_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 13 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_216_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 17 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_222_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 17 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_222_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 40 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_223_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 16 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_225_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 16 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_225_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 16 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_225_3 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = $exam_month AND pb.exam_year = $exam_year AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.course = 10 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 GROUP BY u.ai_code ORDER BY u.ai_code ASC;";
			$summaryQ1 = "SELECT u.temp_district_id, SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_201_1, SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_201_2, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_202_1, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_202_2, SUM(CASE WHEN  pb.subject_id = 9 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_206_1, SUM(CASE WHEN  pb.subject_id = 10 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_207_1, SUM(CASE WHEN  pb.subject_id = 41 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_208_1, SUM(CASE WHEN  pb.subject_id = 11 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_210_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_209_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_209_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_211_1, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_211_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_211_3, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_212_1, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_212_2, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_212_3, SUM(CASE WHEN  pb.subject_id = 5 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_213_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_214_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_214_2, SUM(CASE WHEN  pb.subject_id = 30 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_215_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_216_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_216_2, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_216_3, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_222_1, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_222_2, SUM(CASE WHEN  pb.subject_id = 40 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_223_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_225_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_225_2, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_225_3 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.exam_year = $exam_year AND pb.course = 10 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 GROUP BY u.temp_district_id ORDER BY u.ai_code ASC limit $limit;";
			$summaryQ3 = "SELECT SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_201_1, SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_201_2, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_202_1, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_202_2, SUM(CASE WHEN  pb.subject_id = 9 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_206_1, SUM(CASE WHEN  pb.subject_id = 10 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_207_1, SUM(CASE WHEN  pb.subject_id = 41 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_208_1, SUM(CASE WHEN  pb.subject_id = 11 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_210_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_209_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_209_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_211_1, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_211_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_211_3, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_212_1, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_212_2, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_212_3, SUM(CASE WHEN  pb.subject_id = 5 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_213_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_214_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_214_2, SUM(CASE WHEN  pb.subject_id = 30 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_215_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_216_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_216_2, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_216_3, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_222_1, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_222_2, SUM(CASE WHEN  pb.subject_id = 40 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_223_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_225_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_225_2, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_225_3 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.exam_year = $exam_year AND pb.course = 10 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 ORDER BY u.ai_code ASC limit $limit;";
		}
		*/
		if($course == 12 && $medium == 'hindi'){
			$q1 = "SELECT '12' as course,'hindi' as medium,CONCAT( u.ai_code, '-', u.college_name ) AS college_name, u.temp_district_id, u.ai_code AS ai_code, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 18 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_301_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 18 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_301_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 19 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_302_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 19 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_302_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 20 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_306_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 20 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_306_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 21 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_309_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 21 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_309_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 22 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_311_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 22 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_311_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 23 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_312_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 23 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_312_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 23 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_312_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 24 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_313_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 24 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_313_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 24 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_313_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 25 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_314_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 25 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_314_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 25 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_314_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 26 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_315_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 28 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_316_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 28 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_316_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 27 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_317_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 27 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_317_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 27 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_317_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 29 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_318_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 29 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_318_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 31 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_319_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 31 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_319_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 32 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_320_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 32 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_320_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 32 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_320_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 33 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_321_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 33 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_321_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 33 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_321_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 34 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_328_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 34 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_328_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 35 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_330_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 36 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_331_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 37 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_332_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 37 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_332_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 37 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_332_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 38 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_333_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 38 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_333_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 38 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_333_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 39 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_336_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 46 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_394_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 47 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_395_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 48 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_396_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 51 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_392_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 52 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_391_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 53 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_393_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = $exam_month AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.exam_year = $exam_year AND pb.course = 12 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1  GROUP BY u.ai_code ORDER BY u.ai_code ASC limit $limit;";
			$summaryQ1 =" SELECT u.temp_district_id,SUM(CASE WHEN pb.subject_id = 18 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_301_1,SUM(CASE WHEN pb.subject_id = 18 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_301_2,SUM(CASE WHEN pb.subject_id = 19 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_302_1,SUM(CASE WHEN pb.subject_id = 19 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_302_2,SUM(CASE WHEN pb.subject_id = 20 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_306_1,SUM(CASE WHEN pb.subject_id = 20 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_306_2,SUM(CASE WHEN pb.subject_id = 21 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_309_1,SUM(CASE WHEN pb.subject_id = 21 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_309_2,SUM(CASE WHEN pb.subject_id = 22 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_311_1,SUM(CASE WHEN pb.subject_id = 22 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_311_2,SUM(CASE WHEN pb.subject_id = 23 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_312_1,SUM(CASE WHEN pb.subject_id = 23 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_312_2,SUM(CASE WHEN pb.subject_id = 23 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_312_3,SUM(CASE WHEN pb.subject_id = 24 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_313_1,SUM(CASE WHEN pb.subject_id = 24 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_313_2,SUM(CASE WHEN pb.subject_id = 24 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_313_3,SUM(CASE WHEN pb.subject_id = 25 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_314_1,SUM(CASE WHEN pb.subject_id = 25 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_314_2,SUM(CASE WHEN pb.subject_id = 25 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_314_3,SUM(CASE WHEN pb.subject_id = 26 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_315_1,SUM(CASE WHEN pb.subject_id = 28 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_316_1,SUM(CASE WHEN pb.subject_id = 28 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_316_2,SUM(CASE WHEN pb.subject_id = 27 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_317_1,SUM(CASE WHEN pb.subject_id = 27 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_317_2,SUM(CASE WHEN pb.subject_id = 27 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_317_3,SUM(CASE WHEN pb.subject_id = 29 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_318_1,SUM(CASE WHEN pb.subject_id = 29 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_318_2,SUM(CASE WHEN pb.subject_id = 31 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_319_1,SUM(CASE WHEN pb.subject_id = 31 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_319_2,SUM(CASE WHEN pb.subject_id = 32 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_320_1,SUM(CASE WHEN pb.subject_id = 32 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_320_2,SUM(CASE WHEN pb.subject_id = 32 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_320_3,SUM(CASE WHEN pb.subject_id = 33 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_321_1,SUM(CASE WHEN pb.subject_id = 33 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_321_2,SUM(CASE WHEN pb.subject_id = 33 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_321_3,SUM(CASE WHEN pb.subject_id = 34 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_328_1,SUM(CASE WHEN pb.subject_id = 34 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_328_2,SUM(CASE WHEN pb.subject_id = 35 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_330_1,SUM(CASE WHEN pb.subject_id = 36 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_331_1,SUM(CASE WHEN pb.subject_id = 37 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_332_1,SUM(CASE WHEN pb.subject_id = 37 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_332_2,SUM(CASE WHEN pb.subject_id = 37 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_332_3,SUM(CASE WHEN pb.subject_id = 38 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_333_1,SUM(CASE WHEN pb.subject_id = 38 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_333_2,SUM(CASE WHEN pb.subject_id = 38 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_333_3,SUM(CASE WHEN pb.subject_id = 39 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_336_1,SUM(CASE WHEN pb.subject_id = 46 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_394_1,SUM(CASE WHEN pb.subject_id = 47 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_395_1,SUM(CASE WHEN pb.subject_id = 48 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_396_1,SUM(CASE WHEN pb.subject_id = 51 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_392_1,SUM(CASE WHEN pb.subject_id = 52 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_391_1,SUM(CASE WHEN pb.subject_id = 53 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_393_1
			FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = 1 AND pb.exam_year = 126 AND u.is_allow_for_admission IS NOT NULL AND u.active = 1 AND pb.course = 12 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission IS NOT NULL AND u.active = 1 GROUP BY u.temp_district_id
			ORDER BY u.ai_code ASC;";
			$summaryQ3 = "SELECT SUM(CASE WHEN pb.subject_id = 18 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_301_1, SUM(CASE WHEN pb.subject_id = 18 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_301_2, SUM(CASE WHEN pb.subject_id = 19 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_302_1, SUM(CASE WHEN pb.subject_id = 19 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_302_2, SUM(CASE WHEN pb.subject_id = 20 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_306_1, SUM(CASE WHEN pb.subject_id = 20 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_306_2, SUM(CASE WHEN pb.subject_id = 21 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_309_1, SUM(CASE WHEN pb.subject_id = 21 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_309_2, SUM(CASE WHEN pb.subject_id = 22 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_311_1, SUM(CASE WHEN pb.subject_id = 22 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_311_2, SUM(CASE WHEN pb.subject_id = 23 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_312_1, SUM(CASE WHEN pb.subject_id = 23 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_312_2, SUM(CASE WHEN pb.subject_id = 23 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_312_3, SUM(CASE WHEN pb.subject_id = 24 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_313_1, SUM(CASE WHEN pb.subject_id = 24 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_313_2, SUM(CASE WHEN pb.subject_id = 24 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_313_3, SUM(CASE WHEN pb.subject_id = 25 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_314_1, SUM(CASE WHEN pb.subject_id = 25 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_314_2, SUM(CASE WHEN pb.subject_id = 25 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_314_3, SUM(CASE WHEN pb.subject_id = 26 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_315_1, SUM(CASE WHEN pb.subject_id = 28 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_316_1, SUM(CASE WHEN pb.subject_id = 28 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_316_2, SUM(CASE WHEN pb.subject_id = 27 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_317_1, SUM(CASE WHEN pb.subject_id = 27 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_317_2, SUM(CASE WHEN pb.subject_id = 27 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_317_3, SUM(CASE WHEN pb.subject_id = 29 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_318_1, SUM(CASE WHEN pb.subject_id = 29 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_318_2, SUM(CASE WHEN pb.subject_id = 31 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_319_1, SUM(CASE WHEN pb.subject_id = 31 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_319_2, SUM(CASE WHEN pb.subject_id = 32 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_320_1, SUM(CASE WHEN pb.subject_id = 32 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_320_2, SUM(CASE WHEN pb.subject_id = 32 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_320_3, SUM(CASE WHEN pb.subject_id = 33 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_321_1, SUM(CASE WHEN pb.subject_id = 33 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_321_2, SUM(CASE WHEN pb.subject_id = 33 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_321_3, SUM(CASE WHEN pb.subject_id = 34 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_328_1, SUM(CASE WHEN pb.subject_id = 34 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_328_2, SUM(CASE WHEN pb.subject_id = 35 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_330_1, SUM(CASE WHEN pb.subject_id = 36 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_331_1, SUM(CASE WHEN pb.subject_id = 37 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_332_1, SUM(CASE WHEN pb.subject_id = 37 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_332_2, SUM(CASE WHEN pb.subject_id = 37 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_332_3, SUM(CASE WHEN pb.subject_id = 38 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_333_1, SUM(CASE WHEN pb.subject_id = 38 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_333_2, SUM(CASE WHEN pb.subject_id = 38 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_333_3, SUM(CASE WHEN pb.subject_id = 39 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_336_1, SUM(CASE WHEN pb.subject_id = 46 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_394_1, SUM(CASE WHEN pb.subject_id = 47 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_395_1, SUM(CASE WHEN pb.subject_id = 48 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_396_1, SUM(CASE WHEN pb.subject_id = 51 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_392_1, SUM(CASE WHEN pb.subject_id = 52 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_391_1, SUM(CASE WHEN pb.subject_id = 53 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS Sub_393_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = 1 AND pb.exam_year = 126 AND u.is_allow_for_admission IS NOT NULL AND u.active = 1 AND pb.course = 12 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission IS NOT NULL AND u.active = 1 ORDER BY u.ai_code ASC;";
		}else if($course == 12 && $medium == 'english'){
			$q1 = "SELECT '12' as course,'english' as medium,CONCAT( u.ai_code, '-', u.college_name ) AS college_name, u.temp_district_id, u.ai_code AS ai_code, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 18 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_301_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 18 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_301_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 19 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_302_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 19 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_302_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 20 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_306_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 20 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_306_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 21 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_309_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 21 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_309_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 22 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_311_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 22 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_311_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 23 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_312_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 23 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_312_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 23 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_312_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 24 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_313_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 24 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_313_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 24 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_313_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 25 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_314_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 25 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_314_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 25 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_314_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 26 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_315_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 28 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_316_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 28 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_316_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 27 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_317_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 27 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_317_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 27 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_317_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 29 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_318_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 29 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_318_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 31 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_319_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 31 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_319_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 32 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_320_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 32 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_320_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 32 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_320_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 33 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_321_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 33 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_321_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 33 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_321_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 34 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_328_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 34 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_328_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 35 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_330_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 36 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_331_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 37 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_332_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 37 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_332_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 37 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_332_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 38 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_333_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 38 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_333_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 38 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_333_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 39 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_336_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 46 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_394_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 47 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_395_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 48 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_396_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 51 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_392_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 52 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_391_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 53 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_393_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = $exam_month AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.exam_year = $exam_year AND pb.course = 12 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1  GROUP BY u.ai_code ORDER BY u.ai_code ASC limit $limit;";
			$summaryQ1 =" SELECT u.temp_district_id,SUM(CASE WHEN pb.subject_id = 18 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_301_1,SUM(CASE WHEN pb.subject_id = 18 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_301_2,SUM(CASE WHEN pb.subject_id = 19 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_302_1,SUM(CASE WHEN pb.subject_id = 19 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_302_2,SUM(CASE WHEN pb.subject_id = 20 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_306_1,SUM(CASE WHEN pb.subject_id = 20 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_306_2,SUM(CASE WHEN pb.subject_id = 21 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_309_1,SUM(CASE WHEN pb.subject_id = 21 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_309_2,SUM(CASE WHEN pb.subject_id = 22 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_311_1,SUM(CASE WHEN pb.subject_id = 22 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_311_2,SUM(CASE WHEN pb.subject_id = 23 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_312_1,SUM(CASE WHEN pb.subject_id = 23 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_312_2,SUM(CASE WHEN pb.subject_id = 23 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_312_3,SUM(CASE WHEN pb.subject_id = 24 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_313_1,SUM(CASE WHEN pb.subject_id = 24 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_313_2,SUM(CASE WHEN pb.subject_id = 24 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_313_3,SUM(CASE WHEN pb.subject_id = 25 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_314_1,SUM(CASE WHEN pb.subject_id = 25 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_314_2,SUM(CASE WHEN pb.subject_id = 25 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_314_3,SUM(CASE WHEN pb.subject_id = 26 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_315_1,SUM(CASE WHEN pb.subject_id = 28 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_316_1,SUM(CASE WHEN pb.subject_id = 28 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_316_2,SUM(CASE WHEN pb.subject_id = 27 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_317_1,SUM(CASE WHEN pb.subject_id = 27 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_317_2,SUM(CASE WHEN pb.subject_id = 27 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_317_3,SUM(CASE WHEN pb.subject_id = 29 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_318_1,SUM(CASE WHEN pb.subject_id = 29 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_318_2,SUM(CASE WHEN pb.subject_id = 31 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_319_1,SUM(CASE WHEN pb.subject_id = 31 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_319_2,SUM(CASE WHEN pb.subject_id = 32 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_320_1,SUM(CASE WHEN pb.subject_id = 32 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_320_2,SUM(CASE WHEN pb.subject_id = 32 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_320_3,SUM(CASE WHEN pb.subject_id = 33 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_321_1,SUM(CASE WHEN pb.subject_id = 33 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_321_2,SUM(CASE WHEN pb.subject_id = 33 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_321_3,SUM(CASE WHEN pb.subject_id = 34 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_328_1,SUM(CASE WHEN pb.subject_id = 34 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_328_2,SUM(CASE WHEN pb.subject_id = 35 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_330_1,SUM(CASE WHEN pb.subject_id = 36 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_331_1,SUM(CASE WHEN pb.subject_id = 37 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_332_1,SUM(CASE WHEN pb.subject_id = 37 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_332_2,SUM(CASE WHEN pb.subject_id = 37 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_332_3,SUM(CASE WHEN pb.subject_id = 38 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_333_1,SUM(CASE WHEN pb.subject_id = 38 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_333_2,SUM(CASE WHEN pb.subject_id = 38 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_333_3,SUM(CASE WHEN pb.subject_id = 39 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_336_1,SUM(CASE WHEN pb.subject_id = 46 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_394_1,SUM(CASE WHEN pb.subject_id = 47 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_395_1,SUM(CASE WHEN pb.subject_id = 48 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_396_1,SUM(CASE WHEN pb.subject_id = 51 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_392_1,SUM(CASE WHEN pb.subject_id = 52 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_391_1,SUM(CASE WHEN pb.subject_id = 53 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_393_1
			FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = 1 AND pb.exam_year = 126 AND u.is_allow_for_admission IS NOT NULL AND u.active = 1 AND pb.course = 12 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission IS NOT NULL AND u.active = 1 GROUP BY u.temp_district_id
			ORDER BY u.ai_code ASC;";
			$summaryQ3 = "SELECT SUM(CASE WHEN pb.subject_id = 18 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_301_1, SUM(CASE WHEN pb.subject_id = 18 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_301_2, SUM(CASE WHEN pb.subject_id = 19 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_302_1, SUM(CASE WHEN pb.subject_id = 19 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_302_2, SUM(CASE WHEN pb.subject_id = 20 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_306_1, SUM(CASE WHEN pb.subject_id = 20 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_306_2, SUM(CASE WHEN pb.subject_id = 21 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_309_1, SUM(CASE WHEN pb.subject_id = 21 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_309_2, SUM(CASE WHEN pb.subject_id = 22 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_311_1, SUM(CASE WHEN pb.subject_id = 22 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_311_2, SUM(CASE WHEN pb.subject_id = 23 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_312_1, SUM(CASE WHEN pb.subject_id = 23 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_312_2, SUM(CASE WHEN pb.subject_id = 23 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_312_3, SUM(CASE WHEN pb.subject_id = 24 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_313_1, SUM(CASE WHEN pb.subject_id = 24 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_313_2, SUM(CASE WHEN pb.subject_id = 24 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_313_3, SUM(CASE WHEN pb.subject_id = 25 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_314_1, SUM(CASE WHEN pb.subject_id = 25 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_314_2, SUM(CASE WHEN pb.subject_id = 25 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_314_3, SUM(CASE WHEN pb.subject_id = 26 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_315_1, SUM(CASE WHEN pb.subject_id = 28 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_316_1, SUM(CASE WHEN pb.subject_id = 28 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_316_2, SUM(CASE WHEN pb.subject_id = 27 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_317_1, SUM(CASE WHEN pb.subject_id = 27 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_317_2, SUM(CASE WHEN pb.subject_id = 27 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_317_3, SUM(CASE WHEN pb.subject_id = 29 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_318_1, SUM(CASE WHEN pb.subject_id = 29 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_318_2, SUM(CASE WHEN pb.subject_id = 31 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_319_1, SUM(CASE WHEN pb.subject_id = 31 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_319_2, SUM(CASE WHEN pb.subject_id = 32 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_320_1, SUM(CASE WHEN pb.subject_id = 32 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_320_2, SUM(CASE WHEN pb.subject_id = 32 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_320_3, SUM(CASE WHEN pb.subject_id = 33 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_321_1, SUM(CASE WHEN pb.subject_id = 33 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_321_2, SUM(CASE WHEN pb.subject_id = 33 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_321_3, SUM(CASE WHEN pb.subject_id = 34 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_328_1, SUM(CASE WHEN pb.subject_id = 34 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_328_2, SUM(CASE WHEN pb.subject_id = 35 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_330_1, SUM(CASE WHEN pb.subject_id = 36 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_331_1, SUM(CASE WHEN pb.subject_id = 37 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_332_1, SUM(CASE WHEN pb.subject_id = 37 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_332_2, SUM(CASE WHEN pb.subject_id = 37 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_332_3, SUM(CASE WHEN pb.subject_id = 38 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_333_1, SUM(CASE WHEN pb.subject_id = 38 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS Sub_333_2, SUM(CASE WHEN pb.subject_id = 38 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS Sub_333_3, SUM(CASE WHEN pb.subject_id = 39 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_336_1, SUM(CASE WHEN pb.subject_id = 46 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_394_1, SUM(CASE WHEN pb.subject_id = 47 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_395_1, SUM(CASE WHEN pb.subject_id = 48 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_396_1, SUM(CASE WHEN pb.subject_id = 51 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_392_1, SUM(CASE WHEN pb.subject_id = 52 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_391_1, SUM(CASE WHEN pb.subject_id = 53 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS Sub_393_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = 1 AND pb.exam_year = 126 AND u.is_allow_for_admission IS NOT NULL AND u.active = 1 AND pb.course = 12 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission IS NOT NULL AND u.active = 1 ORDER BY u.ai_code ASC;";
		}else if($course == 10 && $medium == 'hindi'){
			$q1 = " SELECT '10' as course,'hindi' as medium,CONCAT( u.ai_code, '-', u.college_name ) AS college_name, u.temp_district_id, u.ai_code AS ai_code, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 1 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_201_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 1 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_201_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 2 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_202_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 2 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_202_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 9 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_206_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 10 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_207_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 41 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_208_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 11 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_210_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 6 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_209_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 6 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_209_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 4 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_211_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 4 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_211_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 4 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_211_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 3 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_212_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 3 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_212_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 3 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_212_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 5 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_213_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 12 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_214_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 12 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_214_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 30 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_215_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 13 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_216_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 13 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_216_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 13 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_216_3, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 17 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_222_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 17 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_222_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 40 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_223_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 16 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_225_1, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 16 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_225_2, ( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 16 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_225_3,( SELECT hindi_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 7 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_229_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = $exam_month AND pb.exam_year = $exam_year AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.course = 10 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1  GROUP BY u.ai_code ORDER BY u.ai_code ASC limit $limit;";
			$summaryQ1 = "SELECT u.temp_district_id, SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_201_1, SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_201_2, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_202_1, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_202_2, SUM(CASE WHEN  pb.subject_id = 9 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_206_1, SUM(CASE WHEN  pb.subject_id = 10 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_207_1, SUM(CASE WHEN  pb.subject_id = 41 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_208_1, SUM(CASE WHEN  pb.subject_id = 11 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_210_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_209_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_209_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_211_1, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_211_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_211_3, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_212_1, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_212_2, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_212_3, SUM(CASE WHEN  pb.subject_id = 5 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_213_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_214_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_214_2, SUM(CASE WHEN  pb.subject_id = 30 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_215_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_216_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_216_2, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_216_3, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_222_1, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_222_2, SUM(CASE WHEN  pb.subject_id = 40 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_223_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_225_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_225_2, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_225_3, SUM(CASE WHEN  pb.subject_id = 7 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_229_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.exam_year = $exam_year AND pb.course = 10 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 GROUP BY u.temp_district_id ORDER BY u.ai_code ASC limit $limit;";
			$summaryQ3 = "SELECT SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_201_1, SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_201_2, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_202_1, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_202_2, SUM(CASE WHEN  pb.subject_id = 9 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_206_1, SUM(CASE WHEN  pb.subject_id = 10 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_207_1, SUM(CASE WHEN  pb.subject_id = 41 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_208_1, SUM(CASE WHEN  pb.subject_id = 11 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_210_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_209_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_209_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_211_1, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_211_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_211_3, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_212_1, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_212_2, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_212_3, SUM(CASE WHEN  pb.subject_id = 5 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_213_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_214_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_214_2, SUM(CASE WHEN  pb.subject_id = 30 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_215_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_216_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_216_2, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_216_3, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_222_1, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_222_2, SUM(CASE WHEN  pb.subject_id = 40 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_223_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_225_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 2 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_225_2, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 3 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_225_3, SUM(CASE WHEN  pb.subject_id = 7 AND pb.subject_volume_id = 1 THEN pb.hindi_required_book_count ELSE 0 END) AS  Sub_229_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.exam_year = $exam_year AND pb.course = 10 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 ORDER BY u.ai_code ASC limit $limit;";
		}else if($course == 10 && $medium == 'english'){
			$q1 = " SELECT '10' as course,'english' as medium,CONCAT( u.ai_code, '-', u.college_name ) AS college_name, u.temp_district_id, u.ai_code AS ai_code, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 1 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_201_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 1 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_201_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 2 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_202_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 2 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_202_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 9 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_206_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 10 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_207_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 41 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_208_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 11 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_210_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 6 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_209_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 6 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_209_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 4 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_211_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 4 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_211_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 4 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_211_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 3 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_212_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 3 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_212_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 3 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_212_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 5 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_213_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 12 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_214_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 12 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_214_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 30 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_215_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 13 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_216_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 13 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_216_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 13 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_216_3, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 17 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_222_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 17 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_222_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 40 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_223_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 16 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_225_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 16 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_225_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 16 AND pb.subject_volume_id = 3 and pb.deleted_at is null ) AS Sub_225_3,( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 7 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_229_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = $exam_month AND pb.exam_year = $exam_year AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.course = 10 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1  GROUP BY u.ai_code ORDER BY u.ai_code ASC limit $limit;";
			$summaryQ1 = "SELECT u.temp_district_id, SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_201_1, SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_201_2, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_202_1, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_202_2, SUM(CASE WHEN  pb.subject_id = 9 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_206_1, SUM(CASE WHEN  pb.subject_id = 10 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_207_1, SUM(CASE WHEN  pb.subject_id = 41 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_208_1, SUM(CASE WHEN  pb.subject_id = 11 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_210_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_209_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_209_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_211_1, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_211_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_211_3, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_212_1, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_212_2, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_212_3, SUM(CASE WHEN  pb.subject_id = 5 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_213_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_214_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_214_2, SUM(CASE WHEN  pb.subject_id = 30 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_215_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_216_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_216_2, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_216_3, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_222_1, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_222_2, SUM(CASE WHEN  pb.subject_id = 40 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_223_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_225_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_225_2, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_225_3, SUM(CASE WHEN  pb.subject_id = 7 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_229_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.exam_year = $exam_year AND pb.course = 10 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 GROUP BY u.temp_district_id ORDER BY u.ai_code ASC limit $limit;";
			$summaryQ3 = "SELECT SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_201_1, SUM(CASE WHEN  pb.subject_id = 1 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_201_2, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_202_1, SUM(CASE WHEN  pb.subject_id = 2 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_202_2, SUM(CASE WHEN  pb.subject_id = 9 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_206_1, SUM(CASE WHEN  pb.subject_id = 10 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_207_1, SUM(CASE WHEN  pb.subject_id = 41 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_208_1, SUM(CASE WHEN  pb.subject_id = 11 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_210_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_209_1, SUM(CASE WHEN  pb.subject_id = 6 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_209_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_211_1, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_211_2, SUM(CASE WHEN  pb.subject_id = 4 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_211_3, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_212_1, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_212_2, SUM(CASE WHEN  pb.subject_id = 3 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_212_3, SUM(CASE WHEN  pb.subject_id = 5 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_213_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_214_1, SUM(CASE WHEN  pb.subject_id = 12 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_214_2, SUM(CASE WHEN  pb.subject_id = 30 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_215_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_216_1, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_216_2, SUM(CASE WHEN  pb.subject_id = 13 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_216_3, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_222_1, SUM(CASE WHEN  pb.subject_id = 17 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_222_2, SUM(CASE WHEN  pb.subject_id = 40 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_223_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_225_1, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_225_2, SUM(CASE WHEN  pb.subject_id = 16 AND pb.subject_volume_id = 3 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_225_3, SUM(CASE WHEN  pb.subject_id = 7 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_229_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.exam_year = $exam_year AND pb.course = 10 WHERE u.deleted_at IS NULL AND u.is_allow_for_admission is not null AND u.active = 1 ORDER BY u.ai_code ASC limit $limit;";
		}
		
		
		/* 
			$q1 = "SELECT '12' as course,'english' as medium,CONCAT( u.ai_code, '-', u.college_name ) AS college_name, u.temp_district_id, u.ai_code AS ai_code, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 18 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_301_1, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 18 AND pb.subject_volume_id = 2 and pb.deleted_at is null ) AS Sub_301_2, ( SELECT english_required_book_count FROM rs_publication_books AS pb WHERE pb.ai_code = u.ai_code AND pb.subject_id = 19 AND pb.subject_volume_id = 1 and pb.deleted_at is null ) AS Sub_302_1 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = $exam_month AND pb.exam_year = $exam_year AND pb.course = 12 WHERE u.deleted_at IS NULL and u.ai_code = '01020' AND u.is_allow_for_admission is not null AND u.active = 1 GROUP BY u.ai_code ORDER BY u.ai_code ASC limit $limit;";
			$summaryQ1 = "SELECT u.temp_district_id, SUM(CASE WHEN  pb.subject_id = 18 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_301_1, SUM(CASE WHEN  pb.subject_id = 18 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_301_2 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = 1 AND pb.exam_year = 126 AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.course = 12 WHERE u.deleted_at IS NULL and u.ai_code = '01020' AND u.is_allow_for_admission is not null AND u.active = 1 GROUP BY u.temp_district_id ORDER BY u.ai_code ASC;";
			$summaryQ3 = "SELECT SUM(CASE WHEN  pb.subject_id = 18 AND pb.subject_volume_id = 1 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_301_1, SUM(CASE WHEN  pb.subject_id = 18 AND pb.subject_volume_id = 2 THEN pb.english_required_book_count ELSE 0 END) AS  Sub_301_2 FROM rs_aicenter_details u LEFT JOIN rs_publication_books pb ON pb.ai_code = u.ai_code AND pb.deleted_at IS NULL AND pb.exam_month = 1 AND pb.exam_year = 126 AND u.is_allow_for_admission is not null AND u.active = 1 AND pb.course = 12 WHERE u.deleted_at IS NULL  and u.ai_code = '01020' AND u.is_allow_for_admission is not null AND u.active = 1 ORDER BY u.ai_code ASC;";
		*/
		//print_r($q1);
		//dd($summaryQ1);
		$restults[] = DB::select(@$q1);
		$sumQueryrestults[] = DB::select(@$summaryQ1);
		$grandTotalQueryrestults[] = DB::select(@$summaryQ3);
		// dd($sumQueryrestults);
		// $restults[] = DB::select($q2);  
		
		foreach($restults as $k => $result){
			// dd($result);
			foreach($result as $ik => $iv){
				// dd($iv);
				if(@$iv->temp_district_id){
					$tempData = collect($iv)->toArray();
					unset($tempData->course);
					unset($tempData['medium']);
					unset($tempData['temp_district_id']);
					$finalResults[$iv->course][$iv->medium][$iv->temp_district_id][] = $tempData;
				}
				// dd($iv->temp_district_id);
			}
		}
		
		$results = @$finalResults[$course][$medium];
		$sumQueryrestults = collect(@$sumQueryrestults)->toArray();
		// dd($sumQueryrestults);
		$summaryFinalResults = array();
		foreach($sumQueryrestults as $sumk => $sumresult){
			foreach($sumresult as $sumkey => $sumdata){ 
				$sumdata = collect(@$sumdata)->toArray(); 
				$summaryFinalResults[$sumdata['temp_district_id']] = $sumdata;
				unset($summaryFinalResults[$sumdata['temp_district_id']]['temp_district_id']);
			}
		} 
		// dd($sumQueryrestults);
		$i =1;
		$output=array();
		$tempDataInner = array(); 
		if(@$results){
			foreach($results as $district_id => $result){ 
				// $total = null;
				foreach($result as $key => $data){ 
					// dd($data);
					@$output[$i]['id'] = @$i;
					@$output[$i]['ai_code'] = @$data['ai_code'];
					@$output[$i]['college_name'] = @$data['college_name'];
					
					$tempDataInner = $data; 
					unset($tempDataInner['course']);
					unset($tempDataInner['college_name']);
					unset($tempDataInner['ai_code']);
					// dd($tempDataInner);
					foreach ($tempDataInner as $k => $value){  
						if(@$value && $value != null){
							$output[$i][$k] = @$value;
						}else{
							$output[$i][$k] = '0';
						} 
						// dd($output[$i][$k]);
						// $total[$i][$k] += $output[$i][$k];
						// dd($total);
						$k++; 
					}
					// dd($output);
					$i++;
				}
				// dd($output);
				// $output = array(); 
				
				foreach ($tempDataInner as $tempKey => $tempValue){  
					$grandTotalSummaryFinalResults[$district_id][$tempKey] = 0;
					if(@$grandTotalSummaryFinalResults[$district_id][$tempKey]){
						
					}else{
						$grandTotalSummaryFinalResults[$district_id][$tempKey] = 0;
					}
					@$output[$i]['id'] = null;
					@$output[$i]['ai_code'] = null;
					@$output[$i]['college_name'] = 'Total';
					if(@$summaryFinalResults[$district_id][$tempKey] && $summaryFinalResults[$district_id][$tempKey] != null){
						@$output[$i][$tempKey] = $summaryFinalResults[$district_id][$tempKey];
					}else{
						@$output[$i][$tempKey] = '0';	
					}
					$grandTotalSummaryFinalResults[$district_id][$tempKey] = $grandTotalSummaryFinalResults[$district_id][$tempKey] + $output[$i][$tempKey];
				}
				// dd($output);
				$i++;
			}
		}
		
		if(@$grandTotalQueryrestults[0][0]){ 
			foreach ($grandTotalQueryrestults[0][0] as $subject_code => $tempGrandTotalValue){
				@$output[$i]['id'] = null;
				@$output[$i]['ai_code'] = null;
				@$output[$i]['college_name'] = 'Grand Total'; 
				if(@$tempGrandTotalValue){
					@$output[$i][$subject_code] = $tempGrandTotalValue;
				}else{
					@$output[$i][$subject_code] = '0';	
				}  
			} 
		}
		$i++;
		// dd($output);
		return collect($output);
	}
	
	public function headings(): array{
		// dd($this->course);
		if($this->course == 12){
			return ["Sr. No.", "AiCode","Name","Sub_301_1","Sub_301_2","Sub_302_1","Sub_302_2","Sub_306_1","Sub_306_2","Sub_309_1","Sub_309_2","Sub_311_1","Sub_311_2","Sub_312_1","Sub_312_2","Sub_312_3","Sub_313_1","Sub_313_2","Sub_313_3","Sub_314_1","Sub_314_2","Sub_314_3","Sub_315_1","Sub_316_1","Sub_316_2","Sub_317_1","Sub_317_2","Sub_317_3","Sub_318_1","Sub_318_2","Sub_319_1","Sub_319_2","Sub_320_1","Sub_320_2","Sub_320_3","Sub_321_1","Sub_321_2","Sub_321_3","Sub_328_1","Sub_328_2","Sub_330_1","Sub_331_1","Sub_332_1","Sub_332_2","Sub_332_3","Sub_333_1","Sub_333_2","Sub_333_3","Sub_336_1","Sub_394_1","Sub_395_1","Sub_396_1","Sub_392_1","Sub_391_1","Sub_393_1"];
		}else if($this->course == 10){
			return ["Sr. No.", "AiCode","Name","Sub_201_1","Sub_201_2","Sub_202_1","Sub_202_2","Sub_206_1","Sub_207_1","Sub_208_1","Sub_210_1","Sub_209_1","Sub_209_2","Sub_211_1","Sub_211_2","Sub_211_3","Sub_212_1","Sub_212_2","Sub_212_3","Sub_213_1","Sub_214_1","Sub_214_2","Sub_215_1","Sub_216_1","Sub_216_2","Sub_216_3","Sub_222_1","Sub_222_2","Sub_223_1","Sub_225_1","Sub_225_2","Sub_225_3","Sub_229_1"];
		}
    } 
	 
	
	public function registerEvents(): array
    {
		// echo "<pre>";print_r($report->all());exit;
		//border style
		$styleArray = [
				'borders' => [
					'outline' => [
						'borderStyle' => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN,
						'color' => ['argb' => 'FFFF0000'],
						],
					],
				];	
		
		//font style	
		$styleArray1 = [
						'font' => [
							'bold' => true,
							]
						];
		
		//column  text alignment
		$styleArray2 = array(
			'alignment' => array(
				'horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER,
				 )
		);				
		
		//$styleArray3 used for vertical alignment 
		$styleArray3 = array(
			'alignment' => array(
				'vertical' => \PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER,
				 )
		);
		

		$styleArray4 = array(
		'fill' => [
			'fillType' => \PhpOffice\PhpSpreadsheet\Style\Fill::FILL_GRADIENT_LINEAR,
			'startColor' => [
			'argb' => 'FFA0A0A0',
			],
			'endColor' => [
				'argb' => 'FFFFFFFF',
			]
		]
					);
		
		$styleArray5 = array(
						'fill' => [
        'fillType' => \PhpOffice\PhpSpreadsheet\Style\Fill::FILL_SOLID,
        
        'startColor' => [
            'argb' => 'E0E0E0',
        ]]); 
        return [
            AfterSheet::class => function(AfterSheet $event) use ($styleArray, $styleArray1, $styleArray2, 
            $styleArray3, $styleArray4 , $styleArray5)
			{
				$cellRange = 'A1:AZ1'; // All headers
				$event->sheet->getDelegate()->getStyle($cellRange)->getFont()->setSize(13);
				$event->sheet->getStyle($cellRange)->ApplyFromArray($styleArray); 
							
				//Heading formatting...
			 	$event->getSheet()->getDelegate()->getStyle($cellRange)->applyFromArray($styleArray);		
				$event->getSheet()->getDelegate()->getStyle($cellRange)->applyFromArray($styleArray1);
							
							
				//used for making bold
				$event->getSheet()->getDelegate()->getStyle('A')->applyFromArray($styleArray1);
							
							
				//column width set							
				$event->sheet->getDelegate()->getColumnDimension('A')->setWidth(20); 
				// $event ->sheet->getStyle('A:AZ')->getAlignment()->setWrapText(true);
							
				//text center columns...
				// $event ->sheet->getStyle('A1:AZ1')->applyFromArray($styleArray2);
				
				
							
				//sums color formatting...
				$event->sheet->getStyle('A1:AZ1')->applyFromArray($styleArray4);
				$workSheet = $event->sheet->getDelegate();
                $workSheet->freezePane('A2'); // freezing here
				$workSheet->setAutoFilter('A1:AZ1');

				// $event ->sheet->getStyle('A1:G1')->applyFromArray($styleArray5);
				// $event->sheet->getStyle('A1:G1')->setBackground('#CCCCCC');  
				
				
				 // $event->sheet->getDelegate()->getStyle('A1:AZ1')
                                // ->getFont()
                                // ->getColor()
                                // ->setARGB('DD4B39');
								
				// $event->getStyle($cellRange)->setAllBorders('thin');
				// $event->sheet->freezeFirstRowAndColumn();
				// $event->sheet->setAutoFilter();
				$headCellRange = 'A1:AZ1';
				$event->sheet->getStyle($headCellRange)->applyFromArray([
                    'borders' => [
                        'allBorders' => [
                            'borderStyle' => \PhpOffice\PhpSpreadsheet\Style\Border::BORDER_THIN,
                            'color' => ['argb' => '000000'],
                        ],
                    ],
				]);  
				
		    },
        ];
    }
	 
}